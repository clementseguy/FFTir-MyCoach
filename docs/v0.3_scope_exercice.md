# Exercices

Features attendues en v0.3

## Statuts des développements

| ID | Nom feature | Lot | Description synthétique | Statut |
|----|--------------|-----|-------------------------|--------|
| EX1 | Enum Catégories alignée Objectifs | Modèle | Ajouter champ `category` (enum contrôlée) | Fait |
| EX2 | Enum Types (Stand/Maison) | Modèle | Champ `type` (default=Stand) | Fait |
| EX3 | Règle conversion limitée (type=Stand) | Logique | Bloquer planification si type != Stand | Fait |
| EX4 | Carte stats total exercices (écran Objectifs & Exercices) | UI | Affiche simple compteur | Fait |
| EX5 | Section stats haut écran Exercices (total) | UI | Même compteur (pas doublon logique) | Fait |
| EX6 | Icône exercice planifié (≥1 session prévue) | UI | Icône + tooltip sur card | Fait |
| EX7 | Filtre par catégorie | UI | Chips / dropdown multi-sélection | À faire |
| EX8 | Filtre par type | UI | Toggle (Stand / Maison) | À faire |
| EX9 | Tri liste (nom / catégorie / type) | UI | Menu tri persistant (session) | À faire |
| EX10 | Retrait bouton + topbar | UI | Suppression action redondante | Fait |
| EX11 | Bouton Planifier dans card (type Stand) | UI | Bouton action rapide ▶ | Fait |
| EX12 | Bouton Planifier retiré de l'édition | UI | Épure formulaire | Fait |
| EX13 | Bouton Sauvegarder (disquette) topbar édition | UI | Remplace bouton bas | Fait |
| EX14 | Migration compat (backfill cat/type) | Migration | Valeurs par défaut + fallback | Fait |

Légende Statut: À faire | En cours | Fait

## Catégories
Revoir les catégories d'exercice existantes :
- Précision
- Groupement
- Vitesse
- Technique
- Mental
- Physique

= mêmes catégories que pour les Objectifs pour garder une cohérence entre les modèles et faciliter le croisement des données.

Règles métier:
- Catégorie obligatoire (backfill: si absence → `Précision`).
- Aucune création libre par l'utilisateur (liste fermée / contrôlée application).
- Objectifs & Exercices partagent la même enum (alignement futur pour suggestions croisées, non livrées en v0.3).

## Type
Gérer différents types d'exercice :
- Stand : à faire au stand (par défaut)
- Maison : à faire chez soi

Règles :
    1. Seul un exercice de type "Stand" peut être transformé en "session prévue" (feature existante à limiter).

Règles métier complémentaires:
- Type par défaut lors de la création: `Stand`.
- Si type = `Maison`, masquer ou désactiver action Planifier.

## UX / UI

### Ecran "Objectifs & Exercices" - Cohérence
Dans cet écran, la section dédiée aux Exercices doit être cohérente visuellement avec celles dédiées aux Objectifs.

### Ecran "Objectifs & Exercices" - TODOlist
Supprimer la TODO list qui est affichée en bas de l'écran

### Ecran "Objectifs & Exercices" - Statistiques
Ajouter une carte de stats dans l'écran "Objectifs & Exercices" : 
- Nombre d'exercices total

Notes:
- Pas d'autres métriques (pas de notion d'exécution en v0.3).
- Comptage = taille actuelle du repository des exercices.

### Ecran "Exercices" - Statistiques
Ajouter une section de stats en haut de l'écran : 
- Nombre d'exercices total

Option (déplacée à version ultérieure): fenêtres 7/30/60/90j (hors scope v0.3 faute de notion d'exercice réalisé).

### Ecran "Exercices" - Identifier les Exercices planifiés
Afficher quand un Exercice de type "stand" a déjà au moins une "Session prévue" associée grâce à une icône + tooltip.

Détails:
- Condition: existe ≥1 session dont `planned=true` et contenant l'identifiant de l'exercice.
- Icône suggérée: `Icons.schedule` (ou alternative compacte), tooltip: "Au moins une session prévue liée".

### Ecran "Exercices"
1. L'écran Exercice doit être visuellement cohérent avec celui des Objectifs
2. La liste des Exercices doit être filtrable : par catégorie, par type
3. La liste des Exercices doit être triable : nom, catégorie, type
4. Enlever le bouton "+" de la topbar (le bouton "+" vert en bas à droite suffit)
5. Dans la card d'un Exercice de type "Stand", ajout d'un bouton "Planifier" (qui déclenche la planification en Session prévue = feature existante)

Détails implémentation:
- Bouton (icône ▶ + label court) ou simple IconButton avec tooltip.
- Si type != Stand: ne pas afficher.
- Après planification: feedback SnackBar + éventuel rafraîchissement de l'icône planifié.

### Ecran "Exercice" - Création et Edition
1. Le bouton "Sauvegarder" est déplacé dans la topbar, icône disquette
2. Le bouton "Planifier" est supprimé des écrans edition/création

## Migration / Modèles de données
S'assurer que cette version reste compatible avec la version précédente (notamment pour conserver les données de l'utilisateur)

Stratégie migration:
1. Ajouter champs optionnels `category` (string/enum index) & `type` aux exercices existants.
2. Backfill au premier chargement: si `category` null → `precision`; si `type` null → `stand`.
3. Sauvegarde après backfill (idempotent) pour éviter répétitions.
4. Aucune suppression de champ existant; maintien compat ascendante Hive.

Tests à prévoir:
- Création nouvel exercice (cat/type defaults corrects).
- Conversion en session prévue autorisée seulement si type=Stand.
- Icône planifié apparaît après création d'une session prévue.
- Filtre / tri n'affecte pas la stabilité ordre par défaut quand aucun tri explicite.

Hors scope confirmé v0.3:
- Statistiques d'exécution par fenêtres glissantes.
- Champs usageCount / lastPerformedAt.
- Recommandations croisées Objectifs ⇄ Exercices.
- Tags libres.
