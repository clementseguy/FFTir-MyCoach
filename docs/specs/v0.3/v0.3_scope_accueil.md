# Accueil

## Statut

| ID | Feature | Description courte | Lot | État |
|----|---------|--------------------|-----|------|
| F01 | Onglets Synthèse/Avancé | Deux onglets, Synthèse par défaut | A | fait |
| F02 | KPI card 30j (points, groupement, best, sessions mois) | Regrouper les 4 indicateurs existants en première card | A | fait |
| F03 | Courbe points + SMA3 | Évolution points par série avec SMA3 | A | fait |
| F04 | Courbe groupement | Évolution groupement (cm) | A | fait |
| F05 | Répartition catégories (Synthèse) | Bar/stack cat. sessions | A | fait |
| F06 | Distribution points 30j | Buckets points (histogramme) | A | fait |
| F07 | Analyse avancée badges | Consistency / Progression / Distance fréquente / Catégorie dominante | B | fait |
| F08 | Card Rolling 30j vs 60j | Afficher avg30 / avg60 / delta (déplacée Avancé) | B | fait |
| F09 | Badges Streak / Charge / Best groupement | Afficher trio + record badges | B | fait |
| F10 | Scatter Points vs Groupement | Graphe corrélation (10 dernières séries) | B | fait |
| F11 | Répartition distance 30j (Avancé) | Bar chart distances (30j) | B | fait |
| F12 | Suppression "Mes dernières sessions" | Retirer section obsolète | C | fait |
| F13 | Filtrage sessions réalisées uniquement | Exclure statut 'prévue' dans TOUS calculs | C | fait |
| F14 | Ordre chronologique séries strict | Vérifier tri + tests (date + ordre interne) | C | fait |
| F15 | Documentation stats v0.3 | Doc technique complète (statistiques.md) | C | fait |
| F16 | Centraliser tests filtrage/stat windows | Ajout tests unitaires pour filtres 30/60j et statut | C | fait |
| F17 | Titres centrés | Tous les titres de graphs/tableaux centrés | D | fait |
| F18 | Légendes sous composants | Harmoniser position légendes | D | partiel |
| F19 | Renommer page Accueil | Nouveau nom plus explicite | D | fait |
| F20 | Placeholders stables UI | Afficher '-' au lieu de masquer | D | fait |
| F21 | Normalisation groupement (distance) | Décision différée (v0.4) | E | abandonné (v0.3) |
| F22 | Modes Scatter alternatifs | Fenêtre 30j cap / adaptative | E | à faire |
| F23 | Stratégie downsampling Scatter | Downsample >K points | E | à faire |
| F24 | Filtre unique statut (Rolling + StatsService) | Refactor central de filtrage statut | C | fait |
| F25 | Badge record points & groupement | Affichage conditionnel record dernière série | B | fait |
| F26 | Badge Best grp | Affichage best groupement si >0 | B | fait |
| F27 | Tests progression/consistency edge cases | Cas limites < séries mini, avgPrev=0 | C | à faire |
| F28 | Refactor scatter pipeline | Clarifier étapes + tests biais | C | à faire |

Lots:
- Lot A: Structure onglets + vue Synthèse (socle KPI & graphes de base)
- Lot B: Vue Avancé (analyses, rolling, badges, scatter, répartitions avancées)
- Lot C: Cohérence technique & qualité (filtrage statut, tri, tests, docs)
- Lot D: Finitions UI (titres, légendes, renommage, placeholders)
- Lot E: Backlog / évolutions futures (normalisation, modes scatter avancés)

## Statistiques des Sessions

### Simplifier la vue "Accueil"

1. Présenter 2 onglets dans cette page : Synthèse & Avancé. L'onglet "Synthèse" est présenté par défaut.

(proposer d'autres formats adaptés au mobile, pour simplifier la vue des stats, tout en gardant des stats avancées)

2. Dans "Synthèse", présenter (dans l'ordre) :
    - Card avec moyenne points 30j, groupement moy 30J, Best série, Sessions ce mois (existant, à traduire)
    - Evolution points par série + tendance (SMA3) (existant)
    - Evolution groupement (cm) (existant)
    - Répartition catégories (existant)
    - Distribution points (30j) (existant)

3. Dans "Avancé", présenter (dans l'ordre) :
    - Analyse avancée (les 4 labels : consistency, progression, distance fréquente, catégorie dominante) (existant)
    - Card "Rolling 30j vs 60j" (existant, à traduire)
    - Labels "Streak", "Charge" et "Best groupement" (existant, à traduire)
    - Corrélation Points / Groupement (existant)
    - Répartition distance (30j) (existant)

### Simplifier la vue "Accueil" 2

Supprimer la section "mes dernières sessions" (éviter code orphelin)

### Voir les Stats "1 main / 2 mains"

1. Dans l'onglet "Avancé" : Ajouter un graphe qui affiche le score et le groupement, à 1 main, sur les x dernières séries (x = identique aux graphes "évolutions points par série" et "groupement")

2. Dans l'onglet "Avancé" : Ajouter un graphe qui affiche le score et le groupement, à 2 mains, sur les x dernières séries (x = identique aux graphes "évolutions points par série" et "groupement")

### Documenter et expliquer

Documenter et expliquer les statistiques, particluièrement les stats suivantes :
- Tendance SMA3
- Rolling 30j vs 60j
- Charge
- Consistency

### Améliorations mineures

1. Les titres des graphes, tableaux, ... sont **tous** centrés, au-dessus du composant associé

2. Les légendes sont toujorus en dessous du composant

3. Renommer la page Accueil en (nom à trouver, plus parlant et plus "pro")

4. Valider que **toutes** les stats s'apuient uniquement sur les sessions "réalisées" passées (session.date <= date.now). Ajouter des tests. Si ce n'est pas le cas, corriger.

5. Valider que **toutes** les séries sortent dans l'ordre chronologique = date de la session associée + ordre de la série au sein de sa session (série 1 < série 2 < série 3 < ... < série 10). Ajouter des tests. Si ce n'est pas le cas, corriger.

### Notes déplacées depuis statistiques.md (à implémenter ultérieurement)

Ces éléments NE SONT PAS implémentés dans v0.3 mais cadrent les évolutions prévues :


### Décisions Q11–Q15 (03/10/2025)

| # | Sujet | Décision | Détails / Portée |
|---|-------|----------|------------------|
| 11 | Exclusion sessions "prévue" | Exclure totalement | Ignorer toute session au statut `prévue` (et ses séries) dans TOUS les calculs stats. Implémenter un filtre unique dans `StatsService` (et Rolling) avant flatten. |
| 12 | Scatter (corrélation) | Réévaluer fenêtre | 10 dernières séries = compromis lisible; possibilité d'une version 30j évaluée après tests lisibilité. Voir options ci-dessous. |
| 13 | Placeholders UI | Oui (layout stable) | Afficher placeholders "—" plutôt que masquer pour éviter reflow et conserver pédagogie utilisateur. |
| 14 | Normalisation groupement | Différée v0.4 | Ajouter dans backlog v0.4: mention ou normalisation potentielle par distance si nécessaire. |
| 15 | Politique records | Aucune évolution | Pas de persistance supplémentaire, pas de tolérance; recalcul simple conservé pour v0.3. |

### Scatter – Options à évaluer (issue dérivée Q12)

Objectif: conserver lisibilité tout en reflétant mieux la tendance réelle.

1. Option A (Actuel conservé) : Dernières 10 séries (max). Simplicité, très lisible, faible représentativité si volume élevé.
2. Option B (Fenêtre 30 jours brute) : Toutes les séries dans les 30 derniers jours. Risque de densité élevée → chevauchement.
3. Option C (Fenêtre 30 jours + cap) : Séries 30j triées par date, ne garder que les N plus récentes si > N (ex: N=40). Ratio lisibilité / fraîcheur.
4. Option D (Fenêtre 30j + sous-échantillonnage) : Si >K points (ex: K=60), appliquer un downsampling simple (p.ex. prendre 1 point sur 2 ou un algorithme de Largest-Triangle-Three-Buckets) pour lisibilité tout en conservant l'enveloppe.
5. Option E (Fenêtre adaptative) : Si séries 30j <= 20 → tout afficher; 21–60 → cap; >60 → downsample.

Recommandation initiale: commencer par C (cap 30j avec N=40) ou E (adaptative) pour un meilleur compromis, puis mesurer.

Actions futures (si validées):
- Implémenter structure de stratégie (enum ScatterMode { last10, window30Cap, adaptive }) pour test rapide.
- Ajouter métrique interne (compter nb séries filtrées) pour itérations futures.

### Backlog v0.4 (ajouts issus des décisions)
- Filtrage normalisation/annotation groupement par distance (clarification de l'unité ou normalisation future).
- Potentielles améliorations scatter (mode adaptatif, downsampling léger, message dynamique sur densité). 
